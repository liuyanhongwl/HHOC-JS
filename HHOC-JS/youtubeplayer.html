<!DOCTYPE html>
<html>
    <body style="position: absolute; width: 100%; height: 100%; margin: 0;background-color:#ffff00">
        
        <!-- 1. The <iframe> (and video player) will replace this <div> tag. -->
        <div id="player"></div>

        <script>
            // 2. This code loads the IFrame Player API code asynchronously.

            // 3. This function creates an <iframe> (and YouTube player)
            //    after the API code downloads.
            
            alert('111');

            var tag = document.createElement('script');
            
            tag.src = "https://www.youtube.com/iframe_api";
            var firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
            

            var player;
            function onYouTubeIframeAPIReady() {
                alert('onYouTubeIframeAPIReady');
                player = new YT.Player('player', {
                                       'width': '100%',
                                       'height': '100%',
                                       'videoId': '1eyMFKqGfqM',
                                       'playerVars': {
                                       'enablejsapi': 1,
                                       'rel': 0,
                                       'showinfo': 0,
                                       'iv_load_policy': 3,
                                       'modestbranding': 1,
                                       'autohide': 1,
                                       'playsinline': 1,
                                       'theme': 'light',
                                       'origin': 'http://provider.idailycast.com'
                                       },
                                       'events': {
                                       'onReady': 'onPlayerReady',
                                       'onStateChange': 'onStateChange',
                                       'onError': 'onError'
                                       }
                                       });
            }
        
        function stopVideo() {
            player.stopVideo();
        }
        
        // 调整计算的宽高
        var container = document.getElementById("player");
        container.style.height = container.offsetWidth / 16 * 10 + "px";
        
        // 窗口关闭时调用
        window.onbeforeunload = function () {
            alert('onbeforeunload');
            
            ga('send', 'event', 'video', 'played', {
               'metric1': cleanTime()
               });
               ga('send', 'event', 'video', 'playedTime', {
                  'metric1': cleanTime()
                  });
                  ga('set', {
                     'dimension1': '1eyMFKqGfqM',
                     'metric1': cleanTime()
                     });
        };
        
        // 4. The API will call this function when the video player is ready.
        function onPlayerReady(event) {
            alert('onPlayerReady');
            if (${autoplay}) {
                event.target.playVideo();
            }
            
            if (EmbedPlayer != null) {
                EmbedPlayer.notifyPlayerReady();
            }
        }
        
        var isPlayed = false;
        function onStateChange(event) {
            alert('onStateChange');

            switch (event.data) {
                case YT.PlayerState.PLAYING:
                if (cleanTime() == 0) {
                    ga('send', 'event', 'video', 'play', '1eyMFKqGfqM');
                }
                break;
                case YT.PlayerState.PAUSED:
                if (player.getDuration() - player.getCurrentTime() != 0) {
                    ga('send', 'event', 'video', 'paused', '1eyMFKqGfqM');
                }
                break;
                case YT.PlayerState.ENDED:
                ga('send', 'event', 'video', 'ended', '1eyMFKqGfqM');
                ga('send', 'event', 'video', 'played', {
                   'matric1': cleanTime()
                   });
                   break;
            }
        }
        
        function onError(event) {
            alert('onError');

            ga('send', 'event', 'video', 'Play Error', '1eyMFKqGfqM');
            switch (event.data) {
                case 2:
                ga('send', 'event', 'video', 'Invalid Id', '1eyMFKqGfqM');
                break;
                case 5:
                ga('send', 'event', 'video', 'Cannot Play In HTML5', '1eyMFKqGfqM');
                break;
                case 100:
                ga('send', 'event', 'video', 'Not Found', '1eyMFKqGfqM');
                break;
                case 101 || 105:
                ga('send', 'event', 'video', 'Not Allowed', '1eyMFKqGfqM');
                break;
            }
        }
        
        function cleanTime() {
            return Math.round(player.getCurrentTime());
        }
        </script>
        
        hello
    </body>
</html>
